@page "/counter"
@using System.Net.Http.Json
@using System.Net.Http.Headers
@inject IHttpClientFactory factory
@inject TokenModel tokenInfo
@inject ILocalStorageService LocalStorage
@inject ISyncLocalStorageService sessionStorage




<PageTitle>Search</PageTitle>



        <BlazoredTypeahead SearchMethod="@SearchProducts" @bind-Value="selectedProduct">
            <SelectedTemplate >
                @context.name
            </SelectedTemplate>
            <ResultTemplate >
                @context.name

            </ResultTemplate>
            <NotFoundTemplate>
                get otta here
            </NotFoundTemplate>
        </BlazoredTypeahead>

@code
{
    private ProductsModel selectedProduct;
    private HttpClient? client;


    private async Task<IEnumerable<ProductsModel>> SearchProducts(string searchText)
    {
        client = factory.CreateClient("api");

        var response = await client.GetFromJsonAsync<IEnumerable<ProductsModel>>($"Products/Search/{searchText}");
        return response;
    }
}