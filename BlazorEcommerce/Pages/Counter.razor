@page "/counter"
@using System.Net.Http.Json
@using System.Net.Http.Headers
@inject IHttpClientFactory factory
@inject TokenModel tokenInfo
<PageTitle>Counter</PageTitle>

<h1>Products</h1>




@if (products is not null)
{
    @foreach (var p in products)
    {
      <div calss="h2">
          @p.name @p.price @p.quantity

      </div>
    }
}


@code {
    private List<ProductsModel>? products;
    private HttpClient? client;


    protected async override void OnInitialized()
    {
        client = factory.CreateClient("api");
        client.DefaultRequestHeaders.Authorization = new AuthenticationHeaderValue("Bearer", tokenInfo.Token);
        products = await client.GetFromJsonAsync<List<ProductsModel>>("Products");
 
        await InvokeAsync(StateHasChanged);
    }
  
}
